# 登录功能详细交互流程

本文档详细描述了用户登录功能的交互流程，包括正常流程、异常情况及系统反馈。

## 1. 登录流程

### 有序步骤

1.  **进入登录页面**
    *   **用户行为:** 用户通过浏览器访问应用的登录URL。
    *   **系统反馈:**
        *   系统展示登录界面。
        *   界面包含以下元素：
            *   用户名/账号输入框
            *   密码输入框
            *   “登录”按钮
            *   “忘记密码？”链接
            *   “注册新账号”链接/按钮

2.  **输入登录凭证**
    *   **用户行为:** 用户在输入框中分别键入自己的用户名和密码。
    *   **系统反馈:** 输入框实时显示用户输入的内容。密码框中的内容应以掩码（如 `*` 或 `•`）显示。

3.  **提交登录请求**
    *   **用户行为:** 用户点击“登录”按钮。
    *   **系统反馈:**
        *   **前端校验:**
            *   如果用户名或密码为空，按钮旁边会以内联形式提示“用户名和密码不能为空”，并阻止提交。
        *   **视觉反馈:**
            *   “登录”按钮变为禁用状态，并显示加载指示器（如转圈的icon），以防止用户重复点击。

4.  **处理登录结果**
    *   **系统行为:** 前端将用户凭证以 `application/json` 格式 **发送至 `POST /auth/login` API 端点**。

    *   **场景一：登录成功**
        *   **系统反馈:**
            *   服务器验证通过，返回 `200 OK` 状态及包含JWT的响应体: `{"token": "eyJ..."}`。
            *   前端存储令牌（例如：`localStorage`）。
            *   页面跳转到应用主仪表盘（Dashboard）。
            *   页面右上角的用户头像区域显示下拉菜单，包含“进入个人界面”和“登出”两个选项。

    *   **场景二：登录失败（凭证错误）**
        *   **系统反馈:**
            *   服务器验证失败，返回 `401 Unauthorized` 状态及错误信息: `{"message": "账号或密码错误"}`。
            *   登录页面显示明确的错误提示：“账号或密码错误，请重试”。
            *   清除密码输入框的内容。
            *   “登录”按钮恢复可点击状态，并移除加载指示器。

    *   **场景三：登录失败（其他服务端错误）**
        *   **系统反馈:**
            *   服务器返回其他错误状态码 (如 500)。
            *   登录页面显示通用错误提示：“登录服务异常，请稍后重试”。
            *   “登录”按钮恢复可点击状态。

5.  **登出操作**
    *   **用户行为:** 用户在登录状态下，点击头像区域的“登出”按钮。
    *   **系统反馈:**
        *   前端 **调用 `POST /auth/logout` API** (即使此API主要用于服务端记录，客户端也应调用以保持一致)。
        *   前端清除本地存储的用户令牌。
        *   页面跳转回登录页面。

## 2. 边缘情况处理

*   **网络延迟/超时:**
    *   **用户行为:** 用户点击“登录”按钮后，网络连接缓慢或中断。
    *   **系统反馈:**
        *   加载指示器会持续显示一段时间（例如：10秒超时设置）。
        *   若超时，系统会显示全局错误提示，例如：“网络连接超时，请检查您的网络并稍后重试”。
        *   “登录”按钮恢复可点击状态。

*   **输入格式:**
    *   **用户行为:** 用户输入了不符合预设格式的用户名（如果有限制的话，例如特殊字符）。
    *   **系统反馈:** 在用户输入时或提交时进行校验，并给出相应提示，例如：“用户名不能包含特殊字符”。

## 3. 关联流程入口

*   **忘记密码:**
    *   **用户行为:** 在登录页面点击“忘记密码？”链接。
    *   **系统反馈:** 页面跳转至“忘记密码”流程页面。用户可根据提示（输入用户名、象征性的辅助手机号/邮箱）来重设密码。**(注: API文档未定义此流程的具体端点)**

*   **用户注册:**
    *   **用户行为:** 在登录页面点击“注册新账号”链接。
    *   **系统反馈:** 页面跳转至“用户注册”页面，用户可在此创建新账户。**(注: API文档未定义此流程的具体端点)** 